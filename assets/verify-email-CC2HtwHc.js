import{r as o,b as V,j as a,S as j,B as u}from"./index-DOad2NjJ.js";import{V as N}from"./verify-form-BScrRQ8F.js";import{u as v,a as S,V as h}from"./verify-status-CrI4e_uD.js";import{a as b,b as p}from"./card-wva2D4xk.js";import{u as w}from"./use-alert-DqA0D8NJ.js";import"./fetch-DTa09Loc.js";const R=({onRequestVerify:m,isLoading:r,verifyEmail:l,actived2fa:s})=>a.jsxs("div",{className:"space-y-6",children:[a.jsx(h,{verifyEmail:l,actived2fa:s}),a.jsx(b,{className:"w-full border-none shadow-none",children:a.jsx(p,{className:"pt-6",children:a.jsx(u,{className:"w-full",onClick:m,disabled:r,children:r?"Đang gửi mã xác thực...":"Yêu cầu mã xác thực email"})})})]}),F=()=>{var d;const[m,r]=o.useState("check"),[l,s]=o.useState(!1),c=w(),{userInfo:i,updateUserInfo:x}=V(),{verifyEmail:f}=v(),{requestVerifyEmail:n}=S(),g=async()=>{try{s(!0);const e=await n();if(!(e!=null&&e.success)){c.error("Lỗi",e==null?void 0:e.message);return}c.success("Thành công",e==null?void 0:e.message),r("verify")}catch{c.error("Lỗi","Đã có lỗi xảy ra khi gửi mã xác thực")}finally{s(!1)}},y=async e=>{try{const t=await f({code:e});if(!(t!=null&&t.success)){c.error("Lỗi",t==null?void 0:t.message);return}c.success("Thành công",t==null?void 0:t.message),x({...i,VerifiedEmail:"1"}),r("check")}catch{c.error("Lỗi","Đã có lỗi xảy ra khi xác thực")}},E=async()=>{try{const e=await n();if(!(e!=null&&e.success)){c.error("Lỗi",e==null?void 0:e.message);return}c.success("Thông báo",e==null?void 0:e.message)}catch{c.error("Lỗi","Không thể gửi lại mã xác thực")}};return Number(i==null?void 0:i.VerifiedEmail)!==0?a.jsx("div",{className:"md:min-w-[500px] md:max-w-[600px] mx-auto mt-[10vh] rounded-lg px-[12px]",children:a.jsx(h,{verifyEmail:Number(i==null?void 0:i.VerifiedEmail),actived2fa:Number(i==null?void 0:i["2fa"])})}):a.jsx("div",{className:"md:min-w-[500px] md:max-w-[600px] mx-auto mt-[10vh] rounded-lg px-[12px]",children:m==="check"?a.jsx(R,{onRequestVerify:g,isLoading:l,verifyEmail:Number(i==null?void 0:i.VerifiedEmail),actived2fa:Number(i==null?void 0:i["2fa"])}):a.jsxs(a.Fragment,{children:[a.jsx(N,{title:"Xác nhận Email",description:`Vui lòng điền code đã được gửi tới Email: ${(d=JSON.parse(localStorage.getItem(j.USER_INFO)||""))==null?void 0:d.Email}`,onSubmit:y,onResend:E,onExpired:()=>r("check")}),a.jsx("div",{className:"mt-4 flex justify-center",children:a.jsx(u,{variant:"outline",onClick:()=>r("check"),children:"Quay lại"})})]})})};export{F as default};
